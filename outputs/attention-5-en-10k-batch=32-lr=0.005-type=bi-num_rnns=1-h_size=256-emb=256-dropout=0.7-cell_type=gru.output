num_units:                256
restore_from_dir:         None
optimizer:                adam
data_dir:                 data/en-10k
encoder_type:             bi
embedding_size:           256
merge_mode:               concat
learning_rate:            0.005
batch_size:               32
num_enc_layers:           1
num_epochs:               50
model_type:               attention
task:                     5
cell_type:                gru
model_dir:                models/dummy
dropout_keep_prob:        0.7
vocab:                    data/vocab.txt
val_split:                0.1
max_gradient_norm:        1.0
Loading data...
vocabulary size = 487
Building model...
Running initializers...
Creating summary writers...
Performing evaluation before training...
---- Qualitative Analysis
Context: who received the apple ? bill went to the garden . mary journeyed to the hallway . jeff picked up the apple there . mary went back to the bedroom . jeff handed the apple to fred . jeff journeyed to the bedroom . jeff journeyed to the hallway . mary went to the garden . who received the apple ?
Question: who received the apple ?
Answer: fred </s>
Model prediction: 123 123 123 123 123 123 123 123 123 123
=========================
Step 100: train_loss = 1.310769, train_acc = 0.218750, train ppl = 1.925883
Step 200: train_loss = 1.212368, train_acc = 0.500000, train ppl = 1.833421
==== Finshed epoch 1 ====
Evaluating model...
Epoch 1: validation accuracy = 0.286000 -- validation perplexity = 2.092721
Epoch 1: test accuracy: 0.273000
---- Qualitative Analysis
Context: who gave the apple to bill ? bill travelled to the kitchen . jeff travelled to the kitchen . bill travelled to the bathroom . mary travelled to the bathroom . fred journeyed to the kitchen . mary got the apple there . bill went to the kitchen . jeff went back to the garden . jeff went to the kitchen . bill journeyed to the bedroom . mary left the apple . mary got the apple there . fred journeyed to the bedroom . fred journeyed to the hallway . mary left the apple there . mary took the apple there . fred went back to the bathroom . mary left the apple . fred moved to the kitchen . mary grabbed the apple there . fred journeyed to the garden . bill moved to the bathroom . mary passed the apple to bill . bill went to the hallway . fred took the football there . jeff moved to the hallway . who gave the apple to bill ?
Question: who gave the apple to bill ?
Answer: mary </s>
Model prediction: mary </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 300: train_loss = 1.277909, train_acc = 0.406250, train ppl = 1.894499
Step 400: train_loss = 1.539931, train_acc = 0.437500, train ppl = 2.159692
Step 500: train_loss = 1.392029, train_acc = 0.187500, train ppl = 2.005743
==== Finshed epoch 2 ====
Evaluating model...
Epoch 2: validation accuracy = 0.367000 -- validation perplexity = 2.011856
Epoch 2: test accuracy: 0.376000
---- Qualitative Analysis
Context: what did mary give to fred ? mary picked up the apple there . fred travelled to the bedroom . mary handed the apple to fred . mary took the milk there . fred gave the apple to mary . mary gave the apple to fred . fred discarded the apple . mary gave the milk to fred . fred went to the bathroom . jeff travelled to the office . what did mary give to fred ?
Question: what did mary give to fred ?
Answer: milk </s>
Model prediction: milk </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 600: train_loss = 1.427664, train_acc = 0.375000, train ppl = 2.041800
Step 700: train_loss = 1.298069, train_acc = 0.281250, train ppl = 1.913692
Step 800: train_loss = 1.200508, train_acc = 0.312500, train ppl = 1.822582
==== Finshed epoch 3 ====
Evaluating model...
Epoch 3: validation accuracy = 0.432000 -- validation perplexity = 1.786356
Epoch 3: test accuracy: 0.421000
---- Qualitative Analysis
Context: who gave the milk ? bill went to the bedroom . jeff went to the bedroom . mary took the milk there . mary moved to the garden . mary dropped the milk . fred went back to the hallway . mary got the milk there . mary left the milk . mary picked up the milk there . mary went back to the kitchen . bill moved to the garden . jeff moved to the kitchen . fred travelled to the kitchen . jeff went back to the garden . mary handed the milk to fred . fred handed the milk to mary . jeff went to the office . mary left the milk . fred grabbed the milk there . jeff journeyed to the hallway . fred passed the milk to mary . mary handed the milk to fred . bill moved to the office . fred handed the milk to mary . who gave the milk ?
Question: who gave the milk ?
Answer: fred </s>
Model prediction: mary </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 900: train_loss = 1.287902, train_acc = 0.531250, train ppl = 1.903988
Step 1000: train_loss = 1.105025, train_acc = 0.437500, train ppl = 1.737614
Step 1100: train_loss = 1.095094, train_acc = 0.437500, train ppl = 1.729007
==== Finshed epoch 4 ====
Evaluating model...
Epoch 4: validation accuracy = 0.376000 -- validation perplexity = 2.001831
Epoch 4: test accuracy: 0.392000
---- Qualitative Analysis
Context: who did mary give the football to ? mary went to the bedroom . mary went back to the office . jeff got the milk there . bill journeyed to the kitchen . mary went to the bathroom . mary got the football there . jeff discarded the milk there . bill went back to the garden . jeff took the milk there . jeff handed the milk to bill . mary journeyed to the bedroom . fred journeyed to the bedroom . jeff journeyed to the hallway . mary gave the football to fred . fred discarded the football . bill went to the bathroom . mary took the football there . mary handed the football to fred . who did mary give the football to ?
Question: who did mary give the football to ?
Answer: fred </s>
Model prediction: mary </s>
=========================
Step 1200: train_loss = 1.552695, train_acc = 0.125000, train ppl = 2.173519
Step 1300: train_loss = 1.115386, train_acc = 0.406250, train ppl = 1.746638
Step 1400: train_loss = 1.208518, train_acc = 0.468750, train ppl = 1.829896
==== Finshed epoch 5 ====
Evaluating model...
Epoch 5: validation accuracy = 0.402000 -- validation perplexity = 1.838337
Epoch 5: test accuracy: 0.421000
---- Qualitative Analysis
Context: what did mary give to jeff ? fred journeyed to the bathroom . bill went back to the kitchen . fred moved to the office . bill grabbed the milk there . bill discarded the milk . bill journeyed to the hallway . mary moved to the garden . mary grabbed the apple there . fred went back to the hallway . mary dropped the apple there . jeff moved to the bathroom . fred journeyed to the kitchen . fred moved to the bedroom . mary took the apple there . bill went to the office . mary journeyed to the bedroom . mary discarded the apple . bill journeyed to the bedroom . fred got the apple there . fred put down the apple . fred went back to the kitchen . mary travelled to the office . bill travelled to the hallway . mary travelled to the hallway . fred went back to the bathroom . jeff moved to the kitchen . mary journeyed to the garden . mary went to the kitchen . mary journeyed to the hallway . mary went to the kitchen . mary went back to the hallway . mary moved to the kitchen . mary travelled to the bathroom . fred went to the garden . bill went to the bathroom . mary went to the garden . fred went back to the office . jeff moved to the office . jeff moved to the kitchen . bill travelled to the hallway . jeff went to the garden . mary went back to the kitchen . mary took the football there . mary picked up the milk there . mary dropped the football . mary took the football there . mary put down the milk there . mary travelled to the bathroom . fred went back to the bathroom . mary went back to the garden . mary gave the football to jeff . jeff gave the football to mary . mary put down the football . jeff picked up the football there . jeff handed the football to mary . mary passed the football to jeff . what did mary give to jeff ?
Question: what did mary give to jeff ?
Answer: football </s>
Model prediction: apple </s>
=========================
Step 1500: train_loss = 1.189784, train_acc = 0.500000, train ppl = 1.812835
Step 1600: train_loss = 1.472892, train_acc = 0.343750, train ppl = 2.088500
==== Finshed epoch 6 ====
Evaluating model...
Epoch 6: validation accuracy = 0.424000 -- validation perplexity = 1.810897
Epoch 6: test accuracy: 0.394000
---- Qualitative Analysis
Context: who gave the milk to mary ? fred grabbed the football there . jeff picked up the apple there . bill took the milk there . jeff travelled to the hallway . bill dropped the milk . jeff left the apple . jeff moved to the kitchen . mary got the milk there . mary handed the milk to bill . fred went to the hallway . fred picked up the apple there . bill gave the milk to mary . mary dropped the milk . jeff moved to the bathroom . who gave the milk to mary ?
Question: who gave the milk to mary ?
Answer: bill </s>
Model prediction: fred </s>
=========================
Step 1700: train_loss = 1.176180, train_acc = 0.406250, train ppl = 1.800546
Step 1800: train_loss = 1.093195, train_acc = 0.375000, train ppl = 1.727366
Step 1900: train_loss = 1.042221, train_acc = 0.500000, train ppl = 1.683897
==== Finshed epoch 7 ====
Evaluating model...
Epoch 7: validation accuracy = 0.406000 -- validation perplexity = 1.893711
Epoch 7: test accuracy: 0.411000
---- Qualitative Analysis
Context: who gave the apple to jeff ? mary grabbed the apple there . mary gave the apple to jeff . jeff moved to the bathroom . fred went to the bathroom . who gave the apple to jeff ?
Question: who gave the apple to jeff ?
Answer: mary </s>
Model prediction: mary </s>
=========================
Step 2000: train_loss = 1.243400, train_acc = 0.250000, train ppl = 1.862091
Step 2100: train_loss = 1.174145, train_acc = 0.437500, train ppl = 1.798715
Step 2200: train_loss = 1.381095, train_acc = 0.468750, train ppl = 1.994807
==== Finshed epoch 8 ====
Evaluating model...
Epoch 8: validation accuracy = 0.401000 -- validation perplexity = 1.904896
Epoch 8: test accuracy: 0.406000
---- Qualitative Analysis
Context: who gave the apple to mary ? bill got the apple there . bill passed the apple to mary . mary passed the apple to bill . bill handed the apple to mary . fred travelled to the bedroom . mary left the apple there . mary journeyed to the garden . bill picked up the apple there . who gave the apple to mary ?
Question: who gave the apple to mary ?
Answer: bill </s>
Model prediction: jeff </s>
=========================
Step 2300: train_loss = 1.300916, train_acc = 0.406250, train ppl = 1.916419
Step 2400: train_loss = 1.158989, train_acc = 0.375000, train ppl = 1.785136
Step 2500: train_loss = 1.112089, train_acc = 0.343750, train ppl = 1.743761
==== Finshed epoch 9 ====
Evaluating model...
Epoch 9: validation accuracy = 0.409000 -- validation perplexity = 1.833040
Epoch 9: test accuracy: 0.432000
---- Qualitative Analysis
Context: who gave the apple ? mary moved to the office . bill got the milk there . bill discarded the milk . bill moved to the bedroom . fred took the apple there . bill travelled to the hallway . jeff travelled to the garden . fred moved to the garden . bill moved to the kitchen . mary went back to the garden . fred handed the apple to mary . mary took the milk there . who gave the apple ?
Question: who gave the apple ?
Answer: fred </s>
Model prediction: mary </s>
=========================
Step 2600: train_loss = 1.161710, train_acc = 0.343750, train ppl = 1.787566
Step 2700: train_loss = 1.151194, train_acc = 0.312500, train ppl = 1.778192
Step 2800: train_loss = 1.101628, train_acc = 0.375000, train ppl = 1.734664
==== Finshed epoch 10 ====
Evaluating model...
Epoch 10: validation accuracy = 0.429000 -- validation perplexity = 1.805253
Epoch 10: test accuracy: 0.414000
---- Qualitative Analysis
Context: what did fred give to mary ? fred moved to the kitchen . fred travelled to the bathroom . bill went to the kitchen . fred travelled to the hallway . jeff went to the office . bill grabbed the football there . bill journeyed to the bathroom . fred got the milk there . fred moved to the garden . fred handed the milk to mary . mary went to the bedroom . bill grabbed the apple there . fred went to the office . jeff went to the bathroom . what did fred give to mary ?
Question: what did fred give to mary ?
Answer: milk </s>
Model prediction: football </s>
=========================
Step 2900: train_loss = 1.063653, train_acc = 0.406250, train ppl = 1.702038
Step 3000: train_loss = 1.133214, train_acc = 0.375000, train ppl = 1.762277
Step 3100: train_loss = 1.089925, train_acc = 0.468750, train ppl = 1.724544
==== Finshed epoch 11 ====
Evaluating model...
Epoch 11: validation accuracy = 0.442000 -- validation perplexity = 1.805437
Epoch 11: test accuracy: 0.419000
---- Qualitative Analysis
Context: who received the milk ? fred went back to the bedroom . mary travelled to the bathroom . mary got the football there . mary dropped the football . mary got the football there . jeff picked up the milk there . bill travelled to the hallway . jeff left the milk . jeff picked up the milk there . mary moved to the garden . fred travelled to the office . fred moved to the kitchen . bill grabbed the apple there . jeff passed the milk to fred . fred handed the milk to jeff . mary put down the football . who received the milk ?
Question: who received the milk ?
Answer: jeff </s>
Model prediction: fred </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 3200: train_loss = 1.010180, train_acc = 0.562500, train ppl = 1.657135
Step 3300: train_loss = 1.129221, train_acc = 0.437500, train ppl = 1.758762
==== Finshed epoch 12 ====
Evaluating model...
Epoch 12: validation accuracy = 0.414000 -- validation perplexity = 1.750250
Epoch 12: test accuracy: 0.397000
---- Qualitative Analysis
Context: what did fred give to bill ? mary moved to the office . jeff took the apple there . fred went to the hallway . bill grabbed the football there . jeff went back to the kitchen . mary picked up the milk there . bill went to the bedroom . fred travelled to the garden . fred travelled to the bathroom . bill went back to the hallway . mary dropped the milk . bill dropped the football . mary went to the garden . bill went back to the office . jeff moved to the bedroom . bill got the milk there . bill travelled to the bathroom . bill handed the milk to fred . fred gave the milk to bill . jeff travelled to the garden . what did fred give to bill ?
Question: what did fred give to bill ?
Answer: milk </s>
Model prediction: football </s>
=========================
Step 3400: train_loss = 1.026594, train_acc = 0.562500, train ppl = 1.670791
Step 3500: train_loss = 1.061128, train_acc = 0.437500, train ppl = 1.699891
Step 3600: train_loss = 0.932710, train_acc = 0.562500, train ppl = 1.594173
==== Finshed epoch 13 ====
Evaluating model...
Epoch 13: validation accuracy = 0.423000 -- validation perplexity = 1.810132
Epoch 13: test accuracy: 0.397000
---- Qualitative Analysis
Context: who received the football ? jeff travelled to the bedroom . fred journeyed to the bathroom . fred travelled to the kitchen . bill travelled to the kitchen . mary travelled to the kitchen . bill took the football there . bill gave the football to mary . jeff travelled to the office . who received the football ?
Question: who received the football ?
Answer: mary </s>
Model prediction: mary </s>
=========================
Step 3700: train_loss = 1.305849, train_acc = 0.500000, train ppl = 1.921151
Step 3800: train_loss = 1.218778, train_acc = 0.375000, train ppl = 1.839307
Step 3900: train_loss = 0.945253, train_acc = 0.437500, train ppl = 1.604202
==== Finshed epoch 14 ====
Evaluating model...
Epoch 14: validation accuracy = 0.407000 -- validation perplexity = 1.887406
Epoch 14: test accuracy: 0.382000
---- Qualitative Analysis
Context: what did bill give to fred ? mary moved to the hallway . jeff moved to the garden . jeff got the apple there . mary journeyed to the kitchen . fred travelled to the garden . jeff gave the apple to fred . fred travelled to the hallway . fred handed the apple to bill . bill handed the apple to fred . mary got the football there . what did bill give to fred ?
Question: what did bill give to fred ?
Answer: apple </s>
Model prediction: football </s>
=========================
Step 4000: train_loss = 1.172156, train_acc = 0.375000, train ppl = 1.796927
Step 4100: train_loss = 1.232646, train_acc = 0.406250, train ppl = 1.852106
Step 4200: train_loss = 0.967428, train_acc = 0.531250, train ppl = 1.622088
==== Finshed epoch 15 ====
Evaluating model...
Epoch 15: validation accuracy = 0.457000 -- validation perplexity = 1.749039
Epoch 15: test accuracy: 0.461000
---- Qualitative Analysis
Context: who gave the apple to mary ? fred travelled to the bedroom . jeff travelled to the office . fred went to the hallway . bill moved to the office . mary travelled to the bedroom . bill journeyed to the bedroom . jeff went back to the kitchen . bill picked up the apple there . bill handed the apple to mary . jeff grabbed the milk there . who gave the apple to mary ?
Question: who gave the apple to mary ?
Answer: bill </s>
Model prediction: fred </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
