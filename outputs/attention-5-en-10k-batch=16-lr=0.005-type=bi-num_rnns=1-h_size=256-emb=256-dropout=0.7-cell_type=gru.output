batch_size:               16
model_type:               attention
restore_from_dir:         None
val_split:                0.1
encoder_type:             bi
num_units:                256
num_enc_layers:           1
task:                     5
cell_type:                gru
max_gradient_norm:        1.0
model_dir:                models/dummy
embedding_size:           256
vocab:                    data/vocab.txt
optimizer:                adam
num_epochs:               50
data_dir:                 data/en-10k
dropout_keep_prob:        0.7
merge_mode:               concat
learning_rate:            0.005
Loading data...
vocabulary size = 487
Building model...
Running initializers...
Creating summary writers...
Performing evaluation before training...
---- Qualitative Analysis
Context: what did jeff give to mary ? mary moved to the garden . jeff took the apple there . jeff put down the apple . fred moved to the office . bill went to the office . mary moved to the kitchen . jeff took the apple there . mary got the milk there . bill went to the garden . bill moved to the office . fred moved to the bathroom . bill picked up the football there . bill went to the bedroom . mary journeyed to the hallway . bill travelled to the garden . jeff handed the apple to mary . mary discarded the milk there . mary moved to the bedroom . what did jeff give to mary ?
Question: what did jeff give to mary ?
Answer: apple </s>
Model prediction: 267 267 267 267 267 267 267 267 267 267
=========================
Step 100: train_loss = 2.901156, train_acc = 0.000000, train ppl = 4.265580
Step 200: train_loss = 2.930992, train_acc = 0.000000, train ppl = 4.329690
Step 300: train_loss = 2.727568, train_acc = 0.000000, train ppl = 3.910964
Step 400: train_loss = 2.900932, train_acc = 0.062500, train ppl = 4.265101
Step 500: train_loss = 2.793449, train_acc = 0.125000, train ppl = 4.041940
==== Finshed epoch 1 ====
Evaluating model...
Epoch 1: validation accuracy = 0.000000 -- validation perplexity = 4.137681
Epoch 1: test accuracy: 0.000000
---- Qualitative Analysis
Context: who gave the milk ? mary took the milk there . mary went back to the garden . fred went to the office . bill went back to the garden . bill went back to the hallway . fred went to the garden . fred journeyed to the office . bill went to the garden . mary gave the milk to bill . bill gave the milk to mary . mary took the football there . mary passed the football to bill . bill gave the football to mary . jeff moved to the garden . bill travelled to the kitchen . mary gave the football to jeff . jeff discarded the football . mary gave the milk to jeff . who gave the milk ?
Question: who gave the milk ?
Answer: mary </s>
Model prediction: </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 600: train_loss = 3.189652, train_acc = 0.000000, train ppl = 4.927472
Step 700: train_loss = 2.538435, train_acc = 0.000000, train ppl = 3.558066
Step 800: train_loss = 3.032767, train_acc = 0.000000, train ppl = 4.555720
Step 900: train_loss = 2.930639, train_acc = 0.000000, train ppl = 4.328926
Step 1000: train_loss = 3.018836, train_acc = 0.000000, train ppl = 4.524096
Step 1100: train_loss = 2.931006, train_acc = 0.000000, train ppl = 4.329721
==== Finshed epoch 2 ====
Evaluating model...
Epoch 2: validation accuracy = 0.000000 -- validation perplexity = 4.024576
Epoch 2: test accuracy: 0.000000
---- Qualitative Analysis
Context: who received the football ? fred travelled to the garden . bill went to the hallway . mary picked up the milk there . mary handed the milk to bill . bill passed the milk to mary . mary went to the kitchen . mary took the apple there . mary put down the apple . mary journeyed to the bedroom . mary picked up the football there . jeff moved to the bathroom . fred travelled to the office . fred went back to the bedroom . mary passed the football to fred . fred gave the football to mary . mary put down the milk . who received the football ?
Question: who received the football ?
Answer: mary </s>
Model prediction: </s>
=========================
Step 1200: train_loss = 2.927166, train_acc = 0.000000, train ppl = 4.321414
Step 1300: train_loss = 2.679505, train_acc = 0.000000, train ppl = 3.818098
Step 1400: train_loss = 2.805037, train_acc = 0.000000, train ppl = 4.065426
Step 1500: train_loss = 2.515284, train_acc = 0.000000, train ppl = 3.517118
Step 1600: train_loss = 2.739731, train_acc = 0.000000, train ppl = 3.934822
==== Finshed epoch 3 ====
Evaluating model...
Epoch 3: validation accuracy = 0.000000 -- validation perplexity = 4.348040
Epoch 3: test accuracy: 0.000000
---- Qualitative Analysis
Context: who received the football ? bill travelled to the garden . bill moved to the hallway . bill journeyed to the bathroom . jeff took the football there . jeff gave the football to bill . jeff picked up the milk there . fred moved to the bedroom . jeff went to the garden . jeff gave the milk to mary . mary handed the milk to jeff . mary went to the bathroom . bill handed the football to mary . mary left the football . mary travelled to the garden . who received the football ?
Question: who received the football ?
Answer: mary </s>
Model prediction: </s>
=========================
Step 1700: train_loss = 2.803609, train_acc = 0.000000, train ppl = 4.062525
Step 1800: train_loss = 3.019879, train_acc = 0.000000, train ppl = 4.526458
Step 1900: train_loss = 2.817761, train_acc = 0.000000, train ppl = 4.091372
Step 2000: train_loss = 2.672185, train_acc = 0.000000, train ppl = 3.804149
Step 2100: train_loss = 2.862960, train_acc = 0.000000, train ppl = 4.184888
Step 2200: train_loss = 2.555336, train_acc = 0.000000, train ppl = 3.588262
==== Finshed epoch 4 ====
Evaluating model...
Epoch 4: validation accuracy = 0.000000 -- validation perplexity = 3.807469
Epoch 4: test accuracy: 0.000000
---- Qualitative Analysis
Context: who gave the football ? jeff took the football there . jeff passed the football to fred . jeff got the milk there . bill travelled to the bedroom . who gave the football ?
Question: who gave the football ?
Answer: jeff </s>
Model prediction: </s>
=========================
Step 2300: train_loss = 2.918760, train_acc = 0.000000, train ppl = 4.303291
Step 2400: train_loss = 2.944703, train_acc = 0.000000, train ppl = 4.359475
Step 2500: train_loss = 2.708020, train_acc = 0.000000, train ppl = 3.872926
Step 2600: train_loss = 3.024675, train_acc = 0.062500, train ppl = 4.537324
Step 2700: train_loss = 2.817282, train_acc = 0.000000, train ppl = 4.090392
Step 2800: train_loss = 2.682310, train_acc = 0.000000, train ppl = 3.823457
==== Finshed epoch 5 ====
Evaluating model...
Epoch 5: validation accuracy = 0.000000 -- validation perplexity = 3.977725
Epoch 5: test accuracy: 0.000000
---- Qualitative Analysis
Context: who did bill give the football to ? jeff went back to the office . fred got the milk there . fred left the milk . jeff went back to the bedroom . mary went back to the office . mary moved to the kitchen . bill travelled to the office . bill grabbed the football there . mary moved to the garden . bill dropped the football . bill got the football there . bill journeyed to the kitchen . jeff travelled to the office . mary moved to the kitchen . bill gave the football to mary . mary travelled to the garden . who did bill give the football to ?
Question: who did bill give the football to ?
Answer: mary </s>
Model prediction: </s>
=========================
Step 2900: train_loss = 2.556492, train_acc = 0.000000, train ppl = 3.590337
Step 3000: train_loss = 2.724558, train_acc = 0.000000, train ppl = 3.905084
Step 3100: train_loss = 2.880497, train_acc = 0.000000, train ppl = 4.221744
Step 3200: train_loss = 2.684206, train_acc = 0.000000, train ppl = 3.827084
Step 3300: train_loss = 2.795762, train_acc = 0.000000, train ppl = 4.046616
==== Finshed epoch 6 ====
Evaluating model...
Epoch 6: validation accuracy = 0.000000 -- validation perplexity = 3.995548
Epoch 6: test accuracy: 0.000000
---- Qualitative Analysis
Context: who received the football ? jeff travelled to the bedroom . fred journeyed to the bathroom . fred travelled to the kitchen . bill travelled to the kitchen . mary travelled to the kitchen . bill took the football there . bill gave the football to mary . jeff travelled to the office . who received the football ?
Question: who received the football ?
Answer: mary </s>
Model prediction: </s>
=========================
Step 3400: train_loss = 2.820458, train_acc = 0.000000, train ppl = 4.096893
Step 3500: train_loss = 3.048955, train_acc = 0.000000, train ppl = 4.592743
Step 3600: train_loss = 2.734922, train_acc = 0.000000, train ppl = 3.925372
Step 3700: train_loss = 2.753129, train_acc = 0.000000, train ppl = 3.961268
Step 3800: train_loss = 2.803046, train_acc = 0.000000, train ppl = 4.061381
Step 3900: train_loss = 2.535976, train_acc = 0.000000, train ppl = 3.553696
==== Finshed epoch 7 ====
Evaluating model...
Epoch 7: validation accuracy = 0.000000 -- validation perplexity = 3.758029
Epoch 7: test accuracy: 0.000000
---- Qualitative Analysis
Context: what did fred give to bill ? bill went back to the kitchen . mary got the football there . fred went to the garden . fred got the milk there . mary left the football . fred got the apple there . fred travelled to the hallway . bill went to the hallway . mary journeyed to the garden . fred gave the apple to bill . bill gave the apple to fred . fred left the milk there . fred got the milk there . fred gave the apple to bill . fred went back to the bedroom . mary moved to the office . bill travelled to the bathroom . mary went to the kitchen . what did fred give to bill ?
Question: what did fred give to bill ?
Answer: apple </s>
Model prediction: </s>
=========================
Step 4000: train_loss = 2.830406, train_acc = 0.000000, train ppl = 4.117322
Step 4100: train_loss = 2.683164, train_acc = 0.000000, train ppl = 3.825090
Step 4200: train_loss = 2.787399, train_acc = 0.000000, train ppl = 4.029731
Step 4300: train_loss = 2.955671, train_acc = 0.000000, train ppl = 4.383448
Step 4400: train_loss = 2.498640, train_acc = 0.000000, train ppl = 3.487970
Step 4500: train_loss = 2.622253, train_acc = 0.000000, train ppl = 3.710351
==== Finshed epoch 8 ====
Evaluating model...
Epoch 8: validation accuracy = 0.000000 -- validation perplexity = 3.963124
Epoch 8: test accuracy: 0.000000
---- Qualitative Analysis
Context: who received the milk ? jeff journeyed to the office . mary went back to the hallway . fred travelled to the kitchen . bill travelled to the hallway . fred got the milk there . bill travelled to the office . bill moved to the kitchen . fred journeyed to the office . fred gave the milk to jeff . bill grabbed the football there . fred travelled to the bathroom . bill went to the office . mary went back to the garden . bill journeyed to the bedroom . mary got the apple there . bill left the football . fred journeyed to the bedroom . mary moved to the office . mary discarded the apple . jeff handed the milk to mary . who received the milk ?
Question: who received the milk ?
Answer: mary </s>
Model prediction: </s>
=========================
Step 4600: train_loss = 2.855979, train_acc = 0.000000, train ppl = 4.170306
Step 4700: train_loss = 2.685812, train_acc = 0.000000, train ppl = 3.830159
Step 4800: train_loss = 2.786205, train_acc = 0.000000, train ppl = 4.027326
Step 4900: train_loss = 2.593649, train_acc = 0.000000, train ppl = 3.657663
Step 5000: train_loss = 2.564686, train_acc = 0.000000, train ppl = 3.605076
==== Finshed epoch 9 ====
Evaluating model...
Epoch 9: validation accuracy = 0.000000 -- validation perplexity = 4.047191
Epoch 9: test accuracy: 0.000000
---- Qualitative Analysis
Context: who gave the milk ? jeff took the milk there . jeff put down the milk . fred took the milk there . fred handed the milk to jeff . mary went to the office . jeff gave the milk to mary . mary gave the milk to fred . fred passed the milk to mary . bill journeyed to the kitchen . mary handed the milk to fred . who gave the milk ?
Question: who gave the milk ?
Answer: mary </s>
Model prediction: </s>
=========================
Step 5100: train_loss = 2.943454, train_acc = 0.000000, train ppl = 4.356752
Step 5200: train_loss = 3.058138, train_acc = 0.000000, train ppl = 4.613879
Step 5300: train_loss = 2.649979, train_acc = 0.000000, train ppl = 3.762146
Step 5400: train_loss = 2.566916, train_acc = 0.000000, train ppl = 3.609099
Step 5500: train_loss = 2.984222, train_acc = 0.000000, train ppl = 4.446472
Step 5600: train_loss = 2.626944, train_acc = 0.000000, train ppl = 3.719064
==== Finshed epoch 10 ====
Evaluating model...
Epoch 10: validation accuracy = 0.000000 -- validation perplexity = 3.918694
Epoch 10: test accuracy: 0.000000
---- Qualitative Analysis
Context: what did mary give to bill ? fred journeyed to the bedroom . fred got the milk there . fred went back to the kitchen . bill picked up the football there . fred handed the milk to mary . mary moved to the garden . bill dropped the football . mary gave the milk to bill . bill handed the milk to mary . mary passed the milk to bill . jeff went to the garden . jeff journeyed to the kitchen . jeff moved to the bedroom . bill picked up the football there . what did mary give to bill ?
Question: what did mary give to bill ?
Answer: milk </s>
Model prediction: </s>
=========================
Step 5700: train_loss = 2.683788, train_acc = 0.000000, train ppl = 3.826283
Step 5800: train_loss = 2.786236, train_acc = 0.000000, train ppl = 4.027388
Step 5900: train_loss = 2.887231, train_acc = 0.000000, train ppl = 4.235982
Step 6000: train_loss = 2.538377, train_acc = 0.000000, train ppl = 3.557965
Step 6100: train_loss = 2.837659, train_acc = 0.000000, train ppl = 4.132281
==== Finshed epoch 11 ====
Evaluating model...
Epoch 11: validation accuracy = 0.000000 -- validation perplexity = 3.738968
Epoch 11: test accuracy: 0.000000
---- Qualitative Analysis
Context: what did mary give to bill ? mary moved to the kitchen . fred went to the bedroom . mary went back to the hallway . bill got the football there . mary went to the kitchen . fred journeyed to the kitchen . mary moved to the bedroom . jeff travelled to the kitchen . mary moved to the hallway . fred moved to the bedroom . jeff took the milk there . mary went to the bathroom . bill gave the football to mary . mary gave the football to bill . what did mary give to bill ?
Question: what did mary give to bill ?
Answer: football </s>
Model prediction: </s>
=========================
Step 6200: train_loss = 2.922739, train_acc = 0.000000, train ppl = 4.311861
Step 6300: train_loss = 2.652427, train_acc = 0.000000, train ppl = 3.766754
Step 6400: train_loss = 2.865320, train_acc = 0.000000, train ppl = 4.189829
Step 6500: train_loss = 2.933825, train_acc = 0.000000, train ppl = 4.335827
Step 6600: train_loss = 2.770726, train_acc = 0.000000, train ppl = 3.996277
Step 6700: train_loss = 2.333416, train_acc = 0.000000, train ppl = 3.211404
==== Finshed epoch 12 ====
Evaluating model...
Epoch 12: validation accuracy = 0.000000 -- validation perplexity = 3.863894
Epoch 12: test accuracy: 0.000000
---- Qualitative Analysis
Context: what did mary give to bill ? bill travelled to the bathroom . fred picked up the apple there . mary moved to the office . fred handed the apple to mary . mary handed the apple to fred . fred passed the apple to mary . fred moved to the hallway . mary went to the bathroom . mary passed the apple to bill . bill went back to the kitchen . jeff journeyed to the office . mary went to the bedroom . what did mary give to bill ?
Question: what did mary give to bill ?
Answer: apple </s>
Model prediction: </s>
=========================
Step 6800: train_loss = 2.571805, train_acc = 0.000000, train ppl = 3.617933
Step 6900: train_loss = 2.766712, train_acc = 0.000000, train ppl = 3.988264
Step 7000: train_loss = 2.655072, train_acc = 0.000000, train ppl = 3.771738
Step 7100: train_loss = 2.806109, train_acc = 0.000000, train ppl = 4.067605
