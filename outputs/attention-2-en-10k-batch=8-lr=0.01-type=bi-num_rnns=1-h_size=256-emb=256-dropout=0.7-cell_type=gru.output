num_units:                256
learning_rate:            0.01
val_split:                0.1
batch_size:               8
encoder_type:             bi
vocab:                    data/vocab.txt
dropout_keep_prob:        0.7
model_dir:                models/dummy
num_epochs:               50
task:                     2
data_dir:                 data/en-10k
model_type:               attention
optimizer:                adam
cell_type:                gru
restore_from_dir:         None
num_enc_layers:           1
max_gradient_norm:        1.0
merge_mode:               concat
embedding_size:           256
Loading data...
vocabulary size = 487
Building model...
Running initializers...
Creating summary writers...
Performing evaluation before training...
---- Qualitative Analysis
Context: where is the milk ? sandra went back to the bathroom . sandra went to the office . john went to the bedroom . mary went to the bathroom . mary journeyed to the bedroom . john moved to the bathroom . mary picked up the milk there . john went to the bedroom . john went back to the bathroom . sandra went to the garden . mary discarded the milk . daniel journeyed to the hallway . sandra journeyed to the kitchen . daniel travelled to the kitchen . sandra went back to the bedroom . mary journeyed to the garden . daniel picked up the apple there . mary journeyed to the bathroom . mary journeyed to the garden . daniel travelled to the bathroom . sandra got the milk there . sandra went back to the office . where is the milk ?
Question: where is the milk ?
Answer: office </s>
Model prediction: 263 263 263 263 263 263 263 263 263 263
=========================
Step 100: train_loss = 2.900308, train_acc = 0.125000, train ppl = 4.263771
Step 200: train_loss = 1.954894, train_acc = 0.125000, train ppl = 2.657663
Step 300: train_loss = 2.261157, train_acc = 0.000000, train ppl = 3.097448
Step 400: train_loss = 2.296978, train_acc = 0.250000, train ppl = 3.153425
Step 500: train_loss = 2.255045, train_acc = 0.125000, train ppl = 3.087996
Step 600: train_loss = 2.050631, train_acc = 0.375000, train ppl = 2.787975
Step 700: train_loss = 1.948223, train_acc = 0.250000, train ppl = 2.648813
Step 800: train_loss = 1.750914, train_acc = 0.375000, train ppl = 2.399972
Step 900: train_loss = 1.469790, train_acc = 0.250000, train ppl = 2.085263
Step 1000: train_loss = 2.012074, train_acc = 0.125000, train ppl = 2.734741
Step 1100: train_loss = 1.915430, train_acc = 0.125000, train ppl = 2.605736
==== Finshed epoch 1 ====
Evaluating model...
Epoch 1: validation accuracy = 0.151000 -- validation perplexity = 2.809533
Epoch 1: test accuracy: 0.175000
---- Qualitative Analysis
Context: where is the milk ? daniel moved to the kitchen . sandra went back to the bathroom . sandra travelled to the office . daniel went to the office . mary moved to the bathroom . daniel went to the bedroom . daniel grabbed the apple there . john journeyed to the garden . mary picked up the football there . mary dropped the football . sandra went back to the bathroom . daniel journeyed to the kitchen . john went back to the bathroom . john took the milk there . sandra went back to the office . john dropped the milk . daniel moved to the office . mary journeyed to the office . where is the milk ?
Question: where is the milk ?
Answer: bathroom </s>
Model prediction: bathroom </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 1200: train_loss = 1.879228, train_acc = 0.375000, train ppl = 2.558994
Step 1300: train_loss = 1.788275, train_acc = 0.125000, train ppl = 2.445225
Step 1400: train_loss = 1.421816, train_acc = 0.375000, train ppl = 2.035839
Step 1500: train_loss = 2.296968, train_acc = 0.000000, train ppl = 3.153408
Step 1600: train_loss = 2.662245, train_acc = 0.250000, train ppl = 3.785290
Step 1700: train_loss = 1.737698, train_acc = 0.250000, train ppl = 2.384166
Step 1800: train_loss = 2.538524, train_acc = 0.250000, train ppl = 3.558226
Step 1900: train_loss = 1.839058, train_acc = 0.250000, train ppl = 2.508108
Step 2000: train_loss = 1.979209, train_acc = 0.250000, train ppl = 2.690170
Step 2100: train_loss = 2.075853, train_acc = 0.000000, train ppl = 2.823357
Step 2200: train_loss = 1.733887, train_acc = 0.375000, train ppl = 2.379626
==== Finshed epoch 2 ====
Evaluating model...
Epoch 2: validation accuracy = 0.184000 -- validation perplexity = 3.041305
Epoch 2: test accuracy: 0.167000
---- Qualitative Analysis
Context: where is the milk ? john got the milk there . john went back to the office . where is the milk ?
Question: where is the milk ?
Answer: office </s>
Model prediction: bedroom </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 2300: train_loss = 1.791143, train_acc = 0.250000, train ppl = 2.448735
Step 2400: train_loss = 2.026973, train_acc = 0.125000, train ppl = 2.755191
Step 2500: train_loss = 1.684245, train_acc = 0.250000, train ppl = 2.321289
Step 2600: train_loss = 2.689036, train_acc = 0.000000, train ppl = 3.836336
Step 2700: train_loss = 2.221607, train_acc = 0.125000, train ppl = 3.036798
Step 2800: train_loss = 1.790657, train_acc = 0.125000, train ppl = 2.448139
Step 2900: train_loss = 1.665893, train_acc = 0.250000, train ppl = 2.300086
Step 3000: train_loss = 1.491329, train_acc = 0.500000, train ppl = 2.107841
Step 3100: train_loss = 1.588267, train_acc = 0.500000, train ppl = 2.212523
Step 3200: train_loss = 2.128774, train_acc = 0.000000, train ppl = 2.899061
Step 3300: train_loss = 1.835020, train_acc = 0.250000, train ppl = 2.503050
==== Finshed epoch 3 ====
Evaluating model...
Epoch 3: validation accuracy = 0.154000 -- validation perplexity = 2.940989
Epoch 3: test accuracy: 0.171000
---- Qualitative Analysis
Context: where is the milk ? john took the football there . john put down the football . daniel moved to the bathroom . mary went back to the garden . daniel journeyed to the office . mary journeyed to the hallway . john moved to the bathroom . john travelled to the bedroom . john got the football there . sandra moved to the office . john grabbed the milk there . john left the football . john put down the milk . mary went back to the bedroom . sandra travelled to the bedroom . john picked up the football there . where is the milk ?
Question: where is the milk ?
Answer: bedroom </s>
Model prediction: bathroom </s>
=========================
Step 3400: train_loss = 2.631032, train_acc = 0.125000, train ppl = 3.726673
Step 3500: train_loss = 2.066926, train_acc = 0.375000, train ppl = 2.810783
Step 3600: train_loss = 2.189304, train_acc = 0.125000, train ppl = 2.988143
Step 3700: train_loss = 2.588413, train_acc = 0.125000, train ppl = 3.648099
Step 3800: train_loss = 1.917669, train_acc = 0.375000, train ppl = 2.608654
Step 3900: train_loss = 2.936860, train_acc = 0.125000, train ppl = 4.342412
Step 4000: train_loss = 2.173233, train_acc = 0.125000, train ppl = 2.964228
Step 4100: train_loss = 3.204072, train_acc = 0.125000, train ppl = 4.963127
Step 4200: train_loss = 2.252958, train_acc = 0.250000, train ppl = 3.084776
Step 4300: train_loss = 2.076092, train_acc = 0.000000, train ppl = 2.823694
Step 4400: train_loss = 1.792232, train_acc = 0.125000, train ppl = 2.450069
Step 4500: train_loss = 2.769457, train_acc = 0.000000, train ppl = 3.993741
==== Finshed epoch 4 ====
Evaluating model...
Epoch 4: validation accuracy = 0.185000 -- validation perplexity = 3.499081
Epoch 4: test accuracy: 0.187000
---- Qualitative Analysis
Context: where is the apple ? daniel travelled to the garden . sandra went back to the bedroom . john travelled to the bedroom . sandra grabbed the apple there . daniel travelled to the kitchen . sandra left the apple . sandra travelled to the office . sandra went back to the bathroom . where is the apple ?
Question: where is the apple ?
Answer: bedroom </s>
Model prediction: garden </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 4600: train_loss = 1.862743, train_acc = 0.125000, train ppl = 2.537988
Step 4700: train_loss = 2.484303, train_acc = 0.250000, train ppl = 3.463056
Step 4800: train_loss = 2.316670, train_acc = 0.125000, train ppl = 3.184627
Step 4900: train_loss = 2.333160, train_acc = 0.125000, train ppl = 3.210992
Step 5000: train_loss = 1.999454, train_acc = 0.125000, train ppl = 2.717539
Step 5100: train_loss = 1.962890, train_acc = 0.375000, train ppl = 2.668309
Step 5200: train_loss = 2.354232, train_acc = 0.250000, train ppl = 3.245002
Step 5300: train_loss = 2.405506, train_acc = 0.000000, train ppl = 3.329269
Step 5400: train_loss = 1.661486, train_acc = 0.250000, train ppl = 2.295023
Step 5500: train_loss = 1.720731, train_acc = 0.250000, train ppl = 2.364025
Step 5600: train_loss = 2.189260, train_acc = 0.000000, train ppl = 2.988077
==== Finshed epoch 5 ====
Evaluating model...
Epoch 5: validation accuracy = 0.184000 -- validation perplexity = 2.990036
Epoch 5: test accuracy: 0.167000
---- Qualitative Analysis
Context: where is the football ? daniel got the apple there . daniel dropped the apple . mary moved to the bedroom . daniel journeyed to the hallway . mary travelled to the hallway . sandra moved to the bedroom . mary went back to the bathroom . daniel moved to the kitchen . mary went to the kitchen . daniel moved to the office . mary picked up the football there . mary put down the football . where is the football ?
Question: where is the football ?
Answer: kitchen </s>
Model prediction: bedroom </s>
=========================
Step 5700: train_loss = 1.669053, train_acc = 0.375000, train ppl = 2.303723
Step 5800: train_loss = 2.080773, train_acc = 0.250000, train ppl = 2.830311
Step 5900: train_loss = 1.661556, train_acc = 0.125000, train ppl = 2.295104
Step 6000: train_loss = 1.954685, train_acc = 0.125000, train ppl = 2.657385
Step 6100: train_loss = 2.739730, train_acc = 0.125000, train ppl = 3.934820
Step 6200: train_loss = 2.431695, train_acc = 0.125000, train ppl = 3.373152
Step 6300: train_loss = 2.427164, train_acc = 0.125000, train ppl = 3.365518
Step 6400: train_loss = 1.771147, train_acc = 0.250000, train ppl = 2.424375
Step 6500: train_loss = 2.276021, train_acc = 0.250000, train ppl = 3.120553
Step 6600: train_loss = 2.562621, train_acc = 0.000000, train ppl = 3.601356
Step 6700: train_loss = 2.411018, train_acc = 0.250000, train ppl = 3.338458
==== Finshed epoch 6 ====
Evaluating model...
Epoch 6: validation accuracy = 0.151000 -- validation perplexity = 3.315691
Epoch 6: test accuracy: 0.175000
---- Qualitative Analysis
Context: where is the football ? john grabbed the apple there . john journeyed to the office . sandra travelled to the office . sandra took the milk there . sandra discarded the milk . john picked up the milk there . sandra moved to the bedroom . daniel went to the garden . daniel grabbed the football there . sandra went to the bathroom . daniel journeyed to the kitchen . john moved to the garden . where is the football ?
Question: where is the football ?
Answer: kitchen </s>
Model prediction: bathroom </s>
=========================
Step 6800: train_loss = 2.187764, train_acc = 0.000000, train ppl = 2.985842
Step 6900: train_loss = 2.108414, train_acc = 0.250000, train ppl = 2.869698
Step 7000: train_loss = 2.293495, train_acc = 0.250000, train ppl = 3.147938
Step 7100: train_loss = 1.893094, train_acc = 0.375000, train ppl = 2.576797
Step 7200: train_loss = 2.312630, train_acc = 0.000000, train ppl = 3.178200
Step 7300: train_loss = 1.732061, train_acc = 0.250000, train ppl = 2.377455
Step 7400: train_loss = 2.164924, train_acc = 0.000000, train ppl = 2.951939
Step 7500: train_loss = 2.378546, train_acc = 0.000000, train ppl = 3.284692
Step 7600: train_loss = 1.640093, train_acc = 0.375000, train ppl = 2.270605
Step 7700: train_loss = 1.967609, train_acc = 0.375000, train ppl = 2.674613
Step 7800: train_loss = 2.209957, train_acc = 0.000000, train ppl = 3.019159
==== Finshed epoch 7 ====
Evaluating model...
Epoch 7: validation accuracy = 0.185000 -- validation perplexity = 2.687449
Epoch 7: test accuracy: 0.187000
---- Qualitative Analysis
Context: where is the milk ? daniel journeyed to the kitchen . john went to the kitchen . mary went back to the bathroom . sandra picked up the football there . sandra took the milk there . john moved to the office . mary got the apple there . mary dropped the apple there . sandra went to the office . mary grabbed the apple there . sandra went to the bedroom . daniel moved to the bathroom . sandra put down the football there . sandra took the football there . sandra moved to the bathroom . mary moved to the hallway . mary dropped the apple . john travelled to the bedroom . mary grabbed the apple there . mary put down the apple . sandra put down the milk . mary took the apple there . where is the milk ?
Question: where is the milk ?
Answer: bathroom </s>
Model prediction: garden </s>
=========================
Step 7900: train_loss = 2.106685, train_acc = 0.000000, train ppl = 2.867219
Step 8000: train_loss = 2.228980, train_acc = 0.250000, train ppl = 3.048013
Step 8100: train_loss = 3.112177, train_acc = 0.000000, train ppl = 4.740242
Step 8200: train_loss = 1.812600, train_acc = 0.125000, train ppl = 2.475148
Step 8300: train_loss = 2.372838, train_acc = 0.000000, train ppl = 3.275331
Step 8400: train_loss = 2.834816, train_acc = 0.000000, train ppl = 4.126412
Step 8500: train_loss = 3.267272, train_acc = 0.000000, train ppl = 5.122467
Step 8600: train_loss = 2.051199, train_acc = 0.125000, train ppl = 2.788767
Step 8700: train_loss = 2.260399, train_acc = 0.250000, train ppl = 3.096274
Step 8800: train_loss = 1.966725, train_acc = 0.125000, train ppl = 2.673431
Step 8900: train_loss = 2.080360, train_acc = 0.125000, train ppl = 2.829726
Step 9000: train_loss = 2.853849, train_acc = 0.125000, train ppl = 4.165867
==== Finshed epoch 8 ====
Evaluating model...
Epoch 8: validation accuracy = 0.151000 -- validation perplexity = 3.069884
Epoch 8: test accuracy: 0.175000
---- Qualitative Analysis
Context: where is the milk ? mary went to the office . john went to the garden . mary journeyed to the bedroom . daniel got the milk there . daniel journeyed to the bedroom . john moved to the kitchen . where is the milk ?
Question: where is the milk ?
Answer: bedroom </s>
Model prediction: bathroom </s>
=========================
Step 9100: train_loss = 2.796573, train_acc = 0.125000, train ppl = 4.048257
Step 9200: train_loss = 1.836161, train_acc = 0.375000, train ppl = 2.504478
Step 9300: train_loss = 2.525004, train_acc = 0.000000, train ppl = 3.534253
Step 9400: train_loss = 2.232196, train_acc = 0.125000, train ppl = 3.052918
Step 9500: train_loss = 1.833153, train_acc = 0.375000, train ppl = 2.500714
Step 9600: train_loss = 2.098136, train_acc = 0.125000, train ppl = 2.854989
Step 9700: train_loss = 2.126329, train_acc = 0.250000, train ppl = 2.895519
Step 9800: train_loss = 2.160909, train_acc = 0.250000, train ppl = 2.946018
Step 9900: train_loss = 2.278702, train_acc = 0.000000, train ppl = 3.124739
Step 10000: train_loss = 3.537158, train_acc = 0.000000, train ppl = 5.862517
Step 10100: train_loss = 3.110166, train_acc = 0.375000, train ppl = 4.735480
==== Finshed epoch 9 ====
Evaluating model...
Epoch 9: validation accuracy = 0.192000 -- validation perplexity = 2.998901
Epoch 9: test accuracy: 0.187000
---- Qualitative Analysis
Context: where is the football ? daniel went to the hallway . mary moved to the office . sandra picked up the football there . mary grabbed the milk there . mary got the apple there . sandra went back to the hallway . john went to the office . sandra left the football there . where is the football ?
Question: where is the football ?
Answer: hallway </s>
Model prediction: bathroom </s>
=========================
Model checkpoint saved in models/dummy/best_model.ckpt
Step 10200: train_loss = 1.813630, train_acc = 0.250000, train ppl = 2.476423
Step 10300: train_loss = 2.625162, train_acc = 0.125000, train ppl = 3.715752
Step 10400: train_loss = 2.371126, train_acc = 0.125000, train ppl = 3.272528
Step 10500: train_loss = 2.102427, train_acc = 0.125000, train ppl = 2.861121
Step 10600: train_loss = 2.247241, train_acc = 0.250000, train ppl = 3.075970
Step 10700: train_loss = 2.104042, train_acc = 0.000000, train ppl = 2.863432
Step 10800: train_loss = 1.873747, train_acc = 0.125000, train ppl = 2.551990
Step 10900: train_loss = 1.817542, train_acc = 0.250000, train ppl = 2.481271
Step 11000: train_loss = 1.529184, train_acc = 0.125000, train ppl = 2.148117
Step 11100: train_loss = 2.572011, train_acc = 0.125000, train ppl = 3.618304
Step 11200: train_loss = 1.862974, train_acc = 0.250000, train ppl = 2.538281
==== Finshed epoch 10 ====
Evaluating model...
Epoch 10: validation accuracy = 0.155000 -- validation perplexity = 2.597393
Epoch 10: test accuracy: 0.176000
---- Qualitative Analysis
Context: where is the milk ? john went to the office . mary went to the bathroom . sandra moved to the kitchen . john went to the bathroom . daniel went back to the hallway . daniel picked up the milk there . sandra grabbed the football there . john travelled to the garden . daniel journeyed to the bedroom . mary picked up the apple there . john journeyed to the kitchen . mary journeyed to the bedroom . sandra dropped the football there . john moved to the hallway . daniel went to the kitchen . daniel left the milk . sandra took the football there . daniel went to the bathroom . where is the milk ?
Question: where is the milk ?
Answer: kitchen </s>
Model prediction: bathroom </s>
=========================
Step 11300: train_loss = 1.656406, train_acc = 0.500000, train ppl = 2.289201
Step 11400: train_loss = 2.675520, train_acc = 0.000000, train ppl = 3.810498
Step 11500: train_loss = 1.976115, train_acc = 0.125000, train ppl = 2.686012
Step 11600: train_loss = 1.759044, train_acc = 0.125000, train ppl = 2.409748
Step 11700: train_loss = 1.898743, train_acc = 0.250000, train ppl = 2.584085
Step 11800: train_loss = 2.131651, train_acc = 0.250000, train ppl = 2.903234
Step 11900: train_loss = 2.081645, train_acc = 0.250000, train ppl = 2.831545
Step 12000: train_loss = 2.020410, train_acc = 0.125000, train ppl = 2.746164
Step 12100: train_loss = 2.458970, train_acc = 0.125000, train ppl = 3.419468
Step 12200: train_loss = 1.724319, train_acc = 0.250000, train ppl = 2.368269
Step 12300: train_loss = 1.860430, train_acc = 0.250000, train ppl = 2.535055
==== Finshed epoch 11 ====
Evaluating model...
Epoch 11: validation accuracy = 0.139000 -- validation perplexity = 2.942104
Epoch 11: test accuracy: 0.146000
---- Qualitative Analysis
Context: where is the apple ? mary travelled to the bedroom . daniel grabbed the apple there . daniel went to the garden . john travelled to the office . daniel left the apple . john travelled to the hallway . sandra went to the office . daniel journeyed to the hallway . where is the apple ?
Question: where is the apple ?
Answer: garden </s>
Model prediction: office </s>
=========================
Step 12400: train_loss = 2.725816, train_acc = 0.125000, train ppl = 3.907540
Step 12500: train_loss = 3.148416, train_acc = 0.000000, train ppl = 4.826917
Step 12600: train_loss = 2.063922, train_acc = 0.125000, train ppl = 2.806564
Step 12700: train_loss = 2.492275, train_acc = 0.125000, train ppl = 3.476888
Step 12800: train_loss = 2.080642, train_acc = 0.125000, train ppl = 2.830125
Step 12900: train_loss = 2.276764, train_acc = 0.125000, train ppl = 3.121713
Step 13000: train_loss = 2.057800, train_acc = 0.250000, train ppl = 2.797986
Step 13100: train_loss = 2.177083, train_acc = 0.125000, train ppl = 2.969940
Step 13200: train_loss = 2.284337, train_acc = 0.125000, train ppl = 3.133555
Step 13300: train_loss = 2.802391, train_acc = 0.125000, train ppl = 4.060051
Step 13400: train_loss = 1.994287, train_acc = 0.250000, train ppl = 2.710528
Step 13500: train_loss = 2.182744, train_acc = 0.000000, train ppl = 2.978357
==== Finshed epoch 12 ====
Evaluating model...
Epoch 12: validation accuracy = 0.187000 -- validation perplexity = 2.547191
Epoch 12: test accuracy: 0.169000
---- Qualitative Analysis
Context: where is the milk ? daniel grabbed the milk there . daniel discarded the milk . john went back to the bedroom . daniel moved to the kitchen . mary travelled to the hallway . daniel picked up the apple there . sandra journeyed to the office . sandra picked up the milk there . sandra left the milk . john went back to the garden . where is the milk ?
Question: where is the milk ?
Answer: office </s>
Model prediction: bedroom </s>
=========================
Step 13600: train_loss = 1.873264, train_acc = 0.250000, train ppl = 2.551374
Step 13700: train_loss = 1.918443, train_acc = 0.125000, train ppl = 2.609664
Step 13800: train_loss = 1.904282, train_acc = 0.250000, train ppl = 2.591252
Step 13900: train_loss = 2.168590, train_acc = 0.125000, train ppl = 2.957354
Step 14000: train_loss = 1.730081, train_acc = 0.500000, train ppl = 2.375103
Step 14100: train_loss = 2.609584, train_acc = 0.125000, train ppl = 3.686922
Step 14200: train_loss = 2.584186, train_acc = 0.250000, train ppl = 3.640398
Step 14300: train_loss = 2.481750, train_acc = 0.125000, train ppl = 3.458638
Step 14400: train_loss = 2.217470, train_acc = 0.000000, train ppl = 3.030523
Step 14500: train_loss = 1.875575, train_acc = 0.250000, train ppl = 2.554324
Step 14600: train_loss = 1.765496, train_acc = 0.125000, train ppl = 2.417534
==== Finshed epoch 13 ====
Evaluating model...
Epoch 13: validation accuracy = 0.160000 -- validation perplexity = 3.250307
Epoch 13: test accuracy: 0.165000
---- Qualitative Analysis
Context: where is the milk ? sandra journeyed to the garden . sandra travelled to the bathroom . daniel went back to the garden . sandra got the apple there . mary travelled to the bedroom . john went to the hallway . sandra travelled to the office . mary grabbed the milk there . john went to the kitchen . mary moved to the hallway . where is the milk ?
Question: where is the milk ?
Answer: hallway </s>
Model prediction: kitchen </s>
=========================
Step 14700: train_loss = 1.705246, train_acc = 0.375000, train ppl = 2.345792
Step 14800: train_loss = 1.314843, train_acc = 0.625000, train ppl = 1.929810
Step 14900: train_loss = 2.000982, train_acc = 0.000000, train ppl = 2.719616
Step 15000: train_loss = 2.178974, train_acc = 0.125000, train ppl = 2.972748
